<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>담당 과목</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='time_table.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='professor.css') }}">
    <link rel="stylesheet" as="style" crossorigin
          href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" />
</head>
<body>
<div class="sidebar">
    <h2 class="sidebar-title">메뉴</h2>
    <ul id="menuList" class="menu-list"></ul>
</div>

<div class="content-area">
    <header class="full-title-header">
        <h1 class="page-title">담당 과목</h1>
    </header>
    <main class="main-content">
        {% if error %}
            <p class="error">{{ error }}</p>
        {% endif %}
        <div class="class-list">
            {% if subjects %}
                {% for subject in subjects %}
                <div class="class-card">
                    <div class="card-header">
                        <h3>{{ subject.name }}</h3>
                    </div>
                    <div class="card-actions">
                        <a href="{{ url_for('professor.list_subject_sessions', subject_id=subject.subject_id) }}" class="btn-manage">출석 관리</a>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p>담당하고 있는 과목이 없습니다.</p>
            {% endif %}
        </div>
    </main>
</div>

<script>
    const userRole = "{{ role }}";
    const menuList = document.getElementById("menuList");
    let menuItems = [];

    if (userRole === "professor") {
        menuItems = [
            { name: "출석 관리", url: "#" },
            { name: "시간표", url: "{{ url_for('timetable.timetable') }}" },
            { name: "로그아웃", url: "{{ url_for('auth.logout') }}" }
        ];
    }

    const uniqueMenuItems = menuItems.filter((item, index, self) =>
        index === self.findIndex((t) => (
            t.name === item.name
        ))
    );

    uniqueMenuItems.forEach(item => {
        const li = document.createElement("li");
        const link = document.createElement("a");
        link.href = item.url;
        link.textContent = item.name;

        if (item.name === "출석 관리") {
            link.style.color = "#2563eb";
            link.style.fontWeight = "700";
            link.addEventListener('click', (e) => {
                e.preventDefault();
                alert('이미 현재 페이지입니다.');
            });
        }
        li.appendChild(link);
        menuList.appendChild(li);
    });
</script>
</body>
</html>